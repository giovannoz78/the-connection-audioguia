<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>The Connection â€” Audio GuÃ­a</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
  <main class="container">
    <h1>Audio GuÃ­a</h1>
    <p>Elige un idioma para reproducir el audio.</p>

    <div class="langs" role="tablist" aria-label="Seleccionar idioma">
      <!-- EspaÃ±ol (MÃ©xico) -->
      <button class="lang active" role="tab" data-lang="es" aria-selected="true">
        <span class="flag" aria-hidden="true">ğŸ‡²ğŸ‡½</span> EspaÃ±ol
      </button>
      <!-- English (USA) -->
      <button class="lang" role="tab" data-lang="in" aria-selected="false">
        <span class="flag" aria-hidden="true">ğŸ‡ºğŸ‡¸</span> English
      </button>
      <!-- Italiano -->
      <button class="lang" role="tab" data-lang="it" aria-selected="false">
        <span class="flag" aria-hidden="true">ğŸ‡®ğŸ‡¹</span> Italiano
      </button>
      <!-- PortuguÃªs (Brasil) -->
      <button class="lang" role="tab" data-lang="pt" aria-selected="false">
        <span class="flag" aria-hidden="true">ğŸ‡§ğŸ‡·</span> PortuguÃªs
      </button>
    </div>

    <audio id="player" controls preload="none">
      <source id="src-mp3" src="AUDIOS/es.mp3" type="audio/mpeg">
      Tu navegador no soporta audio. <a id="download" href="AUDIOS/es.mp3" download>Descargar</a>
    </audio>
    <footer>
      <span id="meta" class="badge">ES Â· 128kbps Â· MP3</span>
    </footer>
  </main>

<script>
const AUDIO_URLS = {
  es: { url: "AUDIOS/es.mp3", label: "ES Â· 128kbps Â· MP3" },
  in: { url: "AUDIOS/in.mp3", label: "IN Â· 128kbps Â· MP3" }, // ojo: en.mp3
  it: { url: "AUDIOS/it.mp3", label: "IT Â· 128kbps Â· MP3" },
  pt: { url: "AUDIOS/pt.mp3", label: "PT Â· 128kbps Â· MP3" }
};

const qs = new URLSearchParams(location.search);
const preferred = (qs.get("lang") || navigator.language || "es").slice(0,2);
const startLang = Object.keys(AUDIO_URLS).includes(preferred) ? preferred : "es";
const player = document.getElementById("player");
const source = document.getElementById("src-mp3");
const download = document.getElementById("download");
const meta = document.getElementById("meta");

function setLang(lang){
  document.querySelectorAll("button.lang").forEach(b=>{
    const active = b.dataset.lang===lang;
    b.classList.toggle("active", active);
    b.setAttribute("aria-selected", active ? "true":"false");
  });
  const data = AUDIO_URLS[lang];
  if(!data) return;
  source.src = data.url;
  if(download) download.href = data.url;
  if(meta) meta.textContent = data.label;
  player.pause();
  player.load();
  player.play().catch(()=>{ /* autoplay bloqueado */ });
  history.replaceState(null, "", "?lang="+lang);
}

document.querySelectorAll("button.lang").forEach(b=>{
  b.addEventListener("click", ()=> setLang(b.dataset.lang));
});

setLang(startLang);
</script>
</body>
</html>
