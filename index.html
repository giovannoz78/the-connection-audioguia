<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>The Connection — Audio Guía</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <main class="container">
   
    <p>Elige un idioma para reproducir el audio.</p>

    <div class="langs" role="tablist" aria-label="Seleccionar idioma">
      <button class="lang active" role="tab" data-lang="es" aria-selected="true">
        <span class="flag" aria-hidden="true">
          <svg viewBox="0 0 3 2" xmlns="http://www.w3.org/2000/svg">
            <rect width="3" height="2" fill="#AA151B"/>
            <rect x="0" y="0.4" width="3" height="1.2" fill="#F1BF00"/>
          </svg>
        </span>
        Español
      </button>
      <button class="lang" role="tab" data-lang="en" aria-selected="false">
        <span class="flag" aria-hidden="true">
          <svg viewBox="0 0 60 30" xmlns="http://www.w3.org/2000/svg">
            <clipPath id="s"><path d="M0,0 v30 h60 v-30 z"/></clipPath>
            <clipPath id="t"><path d="M30,15 h30 v15 z v15 h-30 z h-30 v-15 z v-15 h30 z"/></clipPath>
            <g clip-path="url(#s)">
              <path d="M0,0 v30 h60 v-30 z" fill="#012169"/>
              <path d="M0,0 L60,30 M60,0 L0,30" stroke="#fff" stroke-width="6"/>
              <path d="M0,0 L60,30 M60,0 L0,30" stroke="#C8102E" stroke-width="4" clip-path="url(#t)"/>
              <path d="M30,0 v30 M0,15 h60" stroke="#fff" stroke-width="10"/>
              <path d="M30,0 v30 M0,15 h60" stroke="#C8102E" stroke-width="6"/>
            </g>
          </svg>
        </span>
        English
      </button>
      <button class="lang" role="tab" data-lang="it" aria-selected="false">
        <span class="flag" aria-hidden="true">
          <svg viewBox="0 0 3 2" xmlns="http://www.w3.org/2000/svg">
            <rect width="1" height="2" fill="#009246"/>
            <rect x="1" width="1" height="2" fill="#fff"/>
            <rect x="2" width="1" height="2" fill="#ce2b37"/>
          </svg>
        </span>
        Italiano
      </button>
      <button class="lang" role="tab" data-lang="pt" aria-selected="false">
        <span class="flag" aria-hidden="true">
          <svg viewBox="0 0 3 2" xmlns="http://www.w3.org/2000/svg">
            <rect width="3" height="2" fill="#006600"/>
            <rect x="1.2" width="1.8" height="2" fill="#FF0000"/>
            <polygon points="1.2,1 1.5,0.5 1.8,1 1.5,1.5" fill="#FFDF00"/>
          </svg>
        </span>
        Português
      </button>
    </div>

    <audio id="player" controls preload="none">
      <source id="src-mp3" src="AUDIOS/es.mp3" type="audio/mpeg">
      Tu navegador no soporta audio. <a id="download" href="AUDIOS/es.mp3" download>Descargar</a>
    </audio>
    <footer>
     <!--  <span id="meta" class="badge">CARLO ACUTIS/span> -->
    </footer>
  </main>

<script>
const AUDIO_URLS = {
  es: { url: "AUDIOS/es.mp3", label: "ES · 128kbps · MP3" },
  en: { url: "AUDIOS/in.mp3", label: "EN · 128kbps · MP3" },
  it: { url: "AUDIOS/it.mp3", label: "IT · 128kbps · MP3" },
  pt: { url: "AUDIOS/pt.mp3", label: "PT · 128kbps · MP3" }
};

const qs = new URLSearchParams(location.search);
const preferred = (qs.get("lang") || navigator.language || "es").slice(0,2);
const startLang = Object.keys(AUDIO_URLS).includes(preferred) ? preferred : "es";
const player = document.getElementById("player");
const source = document.getElementById("src-mp3");
const download = document.getElementById("download");
const meta = document.getElementById("meta");

function setLang(lang){
  document.querySelectorAll("button.lang").forEach(b=>{
    const active = b.dataset.lang===lang;
    b.classList.toggle("active", active);
    b.setAttribute("aria-selected", active ? "true":"false");
  });
  const data = AUDIO_URLS[lang];
  if(!data) return;
  source.src = data.url;
  if(download) download.href = data.url;
  if(meta) meta.textContent = data.label;
  player.pause();
  player.load();
  player.play().catch(()=>{ /* autoplay bloqueado */ });
  history.replaceState(null, "", "?lang="+lang);
}

document.querySelectorAll("button.lang").forEach(b=>{
  b.addEventListener("click", ()=> setLang(b.dataset.lang));
});

setLang(startLang);
</script>
</body>
</html>
